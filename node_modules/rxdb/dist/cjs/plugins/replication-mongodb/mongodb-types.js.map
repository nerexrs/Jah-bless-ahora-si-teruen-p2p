{"version":3,"file":"mongodb-types.js","names":[],"sources":["../../../../src/plugins/replication-mongodb/mongodb-types.ts"],"sourcesContent":["import { TransactionOptions, WithId } from 'mongodb';\nimport type {\n    ReplicationOptions,\n    ReplicationPullOptions,\n    ReplicationPushOptions,\n    WithDeleted\n} from '../../types';\nimport type {\n    MongoDBConnectionString\n} from '../storage-mongodb/mongodb-types';\n\nexport type MongoDBChangeStreamResumeToken = {\n    _data: string;\n};\n\n\nexport type MongoDbCheckpointType = {\n    /**\n     * MongoDB has no wait to iterate over events\n     * from the beginning of time.\n     * Therefore we first iterate over the documents by their\n     * _id field and if that reached an end, we iterate from then on\n     * over the changestream resume token.\n     */\n    iterate: 'changestream' | 'docs-by-id';\n    changestreamResumeToken: MongoDBChangeStreamResumeToken;\n    docId?: string;\n}\n\nexport type MongoDBCheckpointIterationState<MongoDocType> = {\n    docs: WithDeleted<MongoDocType>[];\n    checkpoint: MongoDbCheckpointType;\n};\n\nexport type MongoDbConnectionConfig = {\n    connection: MongoDBConnectionString;\n    databaseName: string;\n    collectionName: string;\n    pushTransactionOptions?: TransactionOptions;\n};\n\nexport type SyncOptionsMongoDB<RxDocType> = Omit<\n    ReplicationOptions<RxDocType, any>,\n    'pull' | 'push' | 'deletedField'\n> & {\n    mongodb: MongoDbConnectionConfig;\n    pull?: Omit<ReplicationPullOptions<RxDocType, MongoDbCheckpointType>, 'handler' | 'stream$'> & {\n    };\n    push?: Omit<ReplicationPushOptions<RxDocType>, 'handler'>;\n};\n"],"mappings":"","ignoreList":[]}